
<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:700,600" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/chocoblast/style/chocoblast.css">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js" type="text/javascript"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script>
            window.onload = function() {
                var playerList = document.getElementById('player-list');
                var chocoblasted = document.getElementById('chocoblasted');
                var pseudoText = document.getElementById('pseudo-text');
                var pseudoInput = document.getElementById('pseudo-input');
                var pseudoForm = document.getElementById('pseudo-form');
            
            
                var socket = io();
                var typing = false;
                
                //Save the player ID
                var playerId;
                socket.on('setPlayerId',function(data){
                    console.log('Player ID : '+data);
                    playerId = data;
                });

                socket.on('setPlayerId',function(data){
                    console.log('Player ID : '+data);
                    playerId = data;
                });

                socket.on('pseudoSaved',function(data){
                    pseudoText.innerHTML = 'Votre Pseudo : ' + data + '</div>';
                });

                socket.on('refreshPlayerList',function(data){
                    playerList.innerHTML = '';
                    for(var playerId in data){
                        console.log(data[playerId]);
                        playerList.innerHTML += '<div class="player">' + data[playerId].pseudo + '</div>';
                    }
                });

                socket.on('changeChocoblasted',function(data){
                    chocoblasted.innerHTML = '<div class="player">' + data.pseudo + '</div>';
                });


                pseudoForm.onsubmit = function(e){
                    e.preventDefault();
                    socket.emit('setPseudo', pseudoInput.value);
                    pseudoInput.value = "";
                }
            }
        </script>
      <title>Chocoblast App !</title>
    </head>
    <body>
        <div class="box container">
            <div class="row">
                <div class="col-4">
                    <div>Les joueurs dans la partie</div>
                    <div class ="playerList" id="player-list">
                    </div>
                    <div>Choisissez votre pseudo</div>
                    <div class ="pseudoBox" id="pseudo-text">
                    </div>
                    <form id="pseudo-form">
                        <input id="pseudo-input" type="text" style="width:30%;height:30px;" autocomplete="off">
                        <input class = "btn" type="submit" value="Send"></input>
                    </form>
                </div>
                <div class="col-8">
                    <div class="h4">The player currently Chocoblasted is : <span class ="chocoblasted" id="chocoblasted"> </span></div>

                </div>

            </div>
       </div>
    </body>
</html>


